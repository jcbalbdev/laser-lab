---
import Layout from "../layouts/Layout.astro";
import BloqueInformativo from "../components/BloqueInformativo.astro";
import BloqInfoDos from "../components/BloqInfoDos.astro";
import BloqInfoTres from "../components/BloqInfoTres.astro";
import BloqInfoCuatro from "../components/BloqInfoCuatro.astro";

const galleryImages = [
  "/galeria/DSCF1313.jpeg",
  "/galeria/DSCF1355.jpeg",
  "/galeria/DSCF1358.jpeg",
  "/galeria/DSCF1362.jpeg",
  "/galeria/DSCF1372.jpeg",
  "/galeria/DSCF1380.jpeg",
  "/galeria/DSCF1389.jpeg",
  "/galeria/DSCF1397.jpeg",
  "/galeria/DSCF1402.jpeg",
  "/galeria/DSCF1431.jpeg",
  "/galeria/DSCF1435.jpeg",
];
---

<Layout title="Laboratorio Laser - Nosotros">
  <main class="main-content">
    <div class="full-width-banner">
      <img
        src="banner-nosotros.jpeg"
        alt="Galería institucional"
        class="banner-img"
      />
    </div>
    <section class="about-section">
      <!-- TABS LOGOS -->
      <div class="tabs-container">
        <div class="tab active" data-target="lasser">
          <img src="Lasser.png" alt="Lasser" class="tab-logo" />
        </div>
        <div class="tab" data-target="jallavet">
          <img src="Jllavet.png" alt="Jallavet" class="tab-logo" />
        </div>
      </div>

      <!-- LINEA SEPARADORA DINAMICA (OPCIONAL O INTEGRADA EN TABS) -->

      <!-- CONTENIDOS -->
      <div class="content-container">
        <!-- LASSER INFO -->
        <div id="lasser" class="tab-content active">
          <p>
            Somos una empresa sólida, orgullosamente peruana, con más de una
            década de experiencia brindando asistencia y asesoría profesional a
            la industria porcina y agropecuaria. Ofrecemos un servicio
            exclusivo, confiable y personalizado, asegurando a nuestros clientes
            una atención oportuna y especializada, acorde a las necesidades
            reales del campo y la producción animal.
          </p>
          <p>
            <strong>Nuestro objetivo:</strong> Brindar un diagnóstico oportuno y preciso
            que permita una mejor prevención y tratamiento de enfermedades, contribuyendo
            directamente al rendimiento productivo y al resultado económico de cada
            empresa. Trabajamos bajo principios de confidencialidad, confiabilidad
            y rapidez.
          </p>
          <p>
            <strong>Nuestro compromiso:</strong> Estamos comprometidos con la mejora
            continua de la calidad de nuestros servicios ofreciendo resultados y asesoría
            técnica de manera eficiente y responsable. Actuamos con compromiso social
            y económico orientados al desarrollo sostenible del país y a la obtención
            de logros rentables para nuestros clientes
          </p>
          <p>
            Contamos con un equipo humano altamente calificado y comprometido,
            preparado para solucionar los desafíos sanitarios del campo,
            respaldado por el avance científico y tecnológico actual.
          </p>
        </div>

        <!-- JALLAVET INFO -->
        <div id="jallavet" class="tab-content">
          <p>
            JALLAVET S.A.C. se consolida como un referente en el sector de la
            salud animal, dedicados a proporcionar soluciones diagnósticas de
            precisión y biotecnología avanzada. Nuestra misión es apoyar el
            crecimiento sostenible de la industria pecuaria a través de
            servicios de análisis rigurosos y tecnología de vanguardia.
          </p>
          <p>
            Nos especializamos en el monitoreo sanitario y la detección temprana
            de patógenos, permitiendo a nuestros socios estratégicos tomar
            decisiones informadas para optimizar su producción. La innovación
            constante y el cumplimiento de normativas internacionales avalan
            nuestra trayectoria.
          </p>
          <p>
            Contamos con un equipo multidisciplinario de profesionales
            apasionados por la sanidad animal, quienes trabajan incansablemente
            para ofrecer un soporte técnico integral. En Jallavet, creemos que
            la calidad diagnóstica es el pilar fundamental para la seguridad
            alimentaria y el bienestar animal en nuestro país.
          </p>
        </div>
      </div>
    </section>

    <script>
      const tabs = document.querySelectorAll(".tab");
      const contents = document.querySelectorAll(".tab-content");

      tabs.forEach((tab) => {
        tab.addEventListener("click", () => {
          // Remove active class from all
          tabs.forEach((t) => t.classList.remove("active"));
          contents.forEach((c) => c.classList.remove("active"));

          // Add active class to clicked
          tab.classList.add("active");
          const targetId = tab.getAttribute("data-target");
          const targetContent = document.getElementById(targetId);
          if (targetContent) {
            targetContent.classList.add("active");
          }
        });
      });
    </script>
    <section class="mv-section">
      <!-- 1. CAPTURA DE VIDEO -->
      <div class="mv-video">
        <img
          src="/galeria/DSCF1435.jpeg"
          alt="Laboratorio Laser"
          class="mv-banner-img"
        />
      </div>

      <!-- 2. MISION Y VISION -->
      <div class="mv-columns">
        <div class="mv-box">
          <h3>MISIÓN</h3>
          <p>
            Brindar un servicio de diagnóstico especializado, rápido, certero y
            confiable, utilizando métodos basados en estrictos estándares
            internacionales realizados por un staff de profesionales altamente
            entrenados y con muchos años de experiencia en el rubro de la
            industria avícola, porcina y agropecuaria; contribuyendo al
            mejoramiento y calidad de vida de la comunidad.
          </p>
        </div>

        <div class="mv-box">
          <h3>VISIÓN</h3>
          <p>
            Ser un laboratorio de diagnósticos reconocido a nivel nacional e
            internacional por sus tecnologías innovadoras, excelencia en su
            servicio y altos estándares de calidad.
          </p>
        </div>
      </div>

      <!-- 3. GALERÍA SLIDER -->
      <div class="gallery-container">
        <!-- Main Viewer -->
        <div class="main-viewer">
          <button id="prevBtn" class="nav-btn prev">❮</button>
          <img
            id="currentImage"
            src={galleryImages[0]}
            alt="Galería Nosotros"
            class="viewer-img"
          />
          <button id="nextBtn" class="nav-btn next">❯</button>
        </div>

        <!-- Thumbnails -->
        <div class="thumbnails-track">
          {
            galleryImages.map((img, index) => (
              <img
                src={img}
                alt={`Thumb ${index}`}
                class={`thumb ${index === 0 ? "active" : ""}`}
                data-index={index}
              />
            ))
          }
        </div>
      </div>
    </section>

    <script define:vars={{ galleryImages }}>
      // Client-side Logic for Slider
      let currentIndex = 0;
      const totalImages = galleryImages.length;
      let slideInterval;
      let fadeTimeout; // Variable para controlar el timeout de la transición

      const currentImgEl = document.getElementById("currentImage");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");
      const thumbs = document.querySelectorAll(".thumb");

      function startAutoPlay() {
        slideInterval = setInterval(() => {
          nextImage(false);
        }, 4000);
      }

      function stopAutoPlay() {
        clearInterval(slideInterval);
      }

      function resetAutoPlay() {
        stopAutoPlay();
        startAutoPlay();
      }

      function updateGallery(index) {
        currentIndex = index;

        // Clear existing timeout to prevent overlap on fast clicks
        if (fadeTimeout) clearTimeout(fadeTimeout);

        // Update Main Image with fast fade effect
        currentImgEl.style.opacity = 0;

        fadeTimeout = setTimeout(() => {
          currentImgEl.src = galleryImages[currentIndex];
          currentImgEl.style.opacity = 1;
        }, 150); // Matches CSS transition

        // Update Thumbs Instantly
        thumbs.forEach((t) => t.classList.remove("active"));
        if (thumbs[currentIndex]) {
          thumbs[currentIndex].classList.add("active");
        }
      }

      function nextImage(manual = true) {
        let newIndex = (currentIndex + 1) % totalImages;
        updateGallery(newIndex);
        if (manual) resetAutoPlay();
      }

      function prevImage() {
        let newIndex = (currentIndex - 1 + totalImages) % totalImages;
        updateGallery(newIndex);
        resetAutoPlay();
      }

      // Listeners
      nextBtn.addEventListener("click", () => nextImage(true));
      prevBtn.addEventListener("click", prevImage);

      thumbs.forEach((t) => {
        t.addEventListener("click", (e) => {
          const idx = parseInt(e.target.dataset.index);
          updateGallery(idx);
          resetAutoPlay();
        });
      });

      // Start Auto Play
      startAutoPlay();
    </script>
  </main>
</Layout>

<style>
  /* Contenedor Principal (main) */
  .main-content {
    width: 100%;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .about-section {
    width: 100%;
    padding: 60px 20px;
    font-family: sans-serif;
    color: #008c5e; /* verde oscuro */
  }

  /* TABS CONTAINER */
  .tabs-container {
    display: flex;
    justify-content: center;
    gap: 80px;
    margin-bottom: 40px;
    border-bottom: 4px solid transparent; /* Reserva espacio si lo quieres */
    position: relative;
    max-width: 800px;
    margin: 0 auto 50px auto;
  }

  /* TAB */
  .tab {
    cursor: pointer;
    padding-bottom: 20px;
    border-bottom: 4px solid transparent;
    transition: all 0.3s ease;
    opacity: 0.5;
  }

  .tab:hover {
    opacity: 0.8;
  }

  .tab.active {
    border-bottom: 4px solid #008c5e; /* Línea verde activa */
    opacity: 1;
  }

  .tab-logo {
    height: 80px;
    object-fit: contain;
  }

  /* CONTENT */
  .content-container {
    max-width: 1100px;
    margin: 0 auto;
    font-size: 20px;
    line-height: 1.7;
    text-align: left;
    position: relative;
    min-height: 400px; /* Evita saltos bruscos de altura */
  }

  .tab-content {
    display: none;
    animation: fadeIn 0.5s ease;
  }

  .tab-content.active {
    display: block;
  }

  .tab-content p {
    margin-bottom: 30px;
    color: #666666;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .mv-section {
    width: 100%;
    padding: 60px 20px;
    font-family: sans-serif;
    color: #008c5e;
    text-align: center;
  }

  /* VIDEO (CAPTURA) */
  .mv-video {
    width: 100%;
    max-width: 1100px;
    margin: 0 auto 40px;
    aspect-ratio: 16 / 9;
    background-color: #000;
    overflow: hidden;
    border-radius: 4px;
  }

  .mv-video .video {
    width: 100%;
    height: 100%;
    border: 0;
    display: block;
  }

  .mv-banner-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  /* MISION / VISION */
  .mv-columns {
    display: flex;
    justify-content: center;
    gap: 60px;
    margin: 50px auto;
    max-width: 1100px;
  }

  .mv-box {
    flex: 1;
    text-align: center;
  }

  .mv-box h3 {
    font-size: 26px;
    font-weight: 800;
    margin-bottom: 20px;
  }

  .mv-box p {
    font-size: 18px;
    line-height: 1.6;
    max-width: 450px;
    margin: 0 auto;
    color: #666666;
  }

  /* SLIDER GALLERY */
  .gallery-container {
    max-width: 1000px;
    margin: 60px auto 0;
    text-align: center;
  }

  /* MAIN VIEWER */
  .main-viewer {
    position: relative;
    width: 100%;
    height: 500px; /* Altura fija para evitar saltos */
    margin-bottom: 20px;
    background-color: #f0f0f0;
    border-radius: 8px;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .viewer-img {
    width: 100%;
    height: 100%;
    object-fit: contain; /* O cover, según prefieras recortar o no */
    transition: opacity 0.2s ease-in-out;
  }

  /* NAV BUTTONS */
  .nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background-color: #008c5e;
    color: white;
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    font-size: 24px;
    cursor: pointer;
    z-index: 10;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: 0.3s;
    user-select: none;
  }

  .nav-btn:hover {
    background-color: #006844;
    transform: translateY(-50%) scale(1.1);
  }

  .prev {
    left: 20px;
  }
  .next {
    right: 20px;
  }

  /* THUMBNAILS */
  .thumbnails-track {
    display: flex;
    gap: 15px;
    overflow-x: auto;
    padding: 10px 5px;
    justify-content: center; /* Centrar si son pocas */
  }

  .thumb {
    width: 100px;
    height: 70px;
    object-fit: cover;
    border-radius: 4px;
    cursor: pointer;
    opacity: 0.6;
    transition: 0.3s;
    border: 2px solid transparent;
  }

  .thumb:hover {
    opacity: 1;
  }

  .thumb.active {
    opacity: 1;
    border-color: #008c5e;
    transform: scale(1.05);
  }

  /* CUSTOM SCROLLBAR FOR THUMBS */
  .thumbnails-track::-webkit-scrollbar {
    height: 8px;
  }
  .thumbnails-track::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 4px;
  }
  .thumbnails-track::-webkit-scrollbar-thumb:hover {
    background: #aaa;
  }

  /* Responsive adjust */
  @media (max-width: 900px) {
    .tabs-container {
      gap: 50px;
      max-width: 600px;
      margin-bottom: 30px;
    }

    .tab-logo {
      height: 60px;
    }

    .about-section {
      padding: 40px 15px;
    }

    .mv-section {
      padding: 40px 15px;
    }
  }

  @media (max-width: 768px) {
    .banner-img {
      max-height: 250px;
      object-fit: cover;
      object-position: center;
    }

    .tabs-container {
      gap: 30px;
      max-width: 100%;
      margin-bottom: 25px;
    }

    .tab-logo {
      height: 50px;
    }

    .tab {
      padding-bottom: 15px;
    }

    .about-section {
      padding: 30px 10px;
    }

    .tab-content p {
      font-size: 16px;
      padding: 0 10px;
    }

    .mv-section {
      padding: 30px 10px;
    }

    .mv-columns {
      flex-direction: column;
      gap: 40px;
    }

    .mv-box h3 {
      font-size: 22px;
    }

    .mv-box p {
      font-size: 16px;
    }

    .main-viewer {
      height: 300px;
    }

    .thumb {
      width: 70px;
      height: 50px;
    }

    .thumbnails-track {
      justify-content: flex-start; /* Permitir scroll en móviles */
    }

    .gallery-container {
      padding: 0 10px;
    }
  }

  @media (max-width: 480px) {
    .banner-img {
      max-height: 200px;
    }

    .tabs-container {
      gap: 20px;
      margin-bottom: 20px;
    }

    .tab-logo {
      height: 40px;
    }

    .tab {
      padding-bottom: 10px;
    }

    .tab.active {
      border-bottom: 3px solid #008c5e;
    }

    .about-section {
      padding: 20px 10px;
    }

    .tab-content p {
      font-size: 14px;
      line-height: 1.5;
    }

    .mv-section {
      padding: 20px 10px;
    }

    .mv-box h3 {
      font-size: 18px;
    }

    .mv-box p {
      font-size: 14px;
    }

    .main-viewer {
      height: 250px;
    }

    .nav-btn {
      width: 35px;
      height: 35px;
      font-size: 18px;
    }

    .thumb {
      width: 60px;
      height: 45px;
    }
  }

  /* BANNER FULL WIDTH */
  .full-width-banner {
    width: 100%;
    margin: 0;
    padding: 0;
    line-height: 0; /* Remove potential bottom space */
  }

  .banner-img {
    width: 100%;
    height: auto;
    display: block;
    object-fit: cover;
  }
</style>
